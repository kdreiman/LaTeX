% the various libraries we will be using
\ifdefined\suppressfontnotfounderror
  \expandafter\let\csname xetex_suppressfontnotfounderror:D\endcsname
    \suppressfontnotfounderror
\else
  \expandafter\let\csname xetex_suppressfontnotfounderror:D\endcsname
  \luatexsuppressfontnotfounderror
\fi
%\usepackage[T1]{fontenc}

% accents
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}

\usepackage{tikz}
\usetikzlibrary{calc}

\usepackage{textgreek}
\usepackage{textcomp}
\usepackage{upgreek}


\usepackage[none]{hyphenat}
\usepackage{fontspec}
\defaultfontfeatures{Ligatures=TeX}
\usepackage{blindtext}
\usepackage{multirow}
\usepackage{csvsimple}
\usepackage{subfig}
\usepackage{caption}

\usepackage{relsize}

\usepackage{transparent}
\usepackage{cancel}

\usepackage{feynmp-auto}
\usepackage{amsmath}
\usepackage{amssymb}

\usepackage{multicol}
\usepackage{color}
%\usepackage[dvipsnames]{xcolor}

\usepackage{hyperref}

\usepackage{listings}

% bold math symbols
\usepackage{bm}

\usepackage{colortbl}

\usepackage{array}

\usepackage{tabulary}
\usepackage{tabularx}
\usepackage{longtable}
\usepackage{seqsplit}

\usepackage{calc}

% line spacing
%\usepackage{setspace}


% list indent
\setlength{\leftmargini}{0.5cm}
\setlength{\leftmarginii}{0.5cm}
\setlength{\leftmarginiii}{0.5cm}

\lstset{ breakatwhitespace,
  language=C++,
  columns=fullflexible,
  keepspaces,
  breaklines,
  tabsize=3, 
  showstringspaces=false,
  extendedchars=true }

% lstlisting breaklines without white space
\makeatletter
\def\lst@lettertrue{\let\lst@ifletter\iffalse}
\makeatother

% nice coloured boxes
\usepackage{pst-node}
\psset{arrowscale=2,arrows=->}
\def\VPh{\vphantom{\displaystyle\sum_{i=n}^m {i^2}}}
\def\psBox#1#2{\psframebox[fillcolor=#1,fillstyle=solid]{\VPh\displaystyle#2}}


\newcommand{\myfbox}[2]{\fcolorbox{#1}{white}{#2}}

\usepackage{tikz}

\usepackage{mathtools}
\usepackage{hf-tikz}

\newcommand{\highlight}[2][yellow]{\mathchoice%
  {\colorbox{#1}{$\displaystyle#2$}}%
  {\colorbox{#1}{$\textstyle#2$}}%
  {\colorbox{#1}{$\scriptstyle#2$}}%
  {\colorbox{#1}{$\scriptscriptstyle#2$}}}%

%%%%

\newenvironment{xitemize}{%
  \smaller
  \itemize
}{%
  \enditemize
}
% define colours
\definecolor{UVicBlue}{RGB}{0,41,87}
\definecolor{TemplateRed}{RGB}{230,37,52}
\definecolor{ATLASBlue}{RGB}{11,128,192}
\definecolor{ATLASBlue_light}{RGB}{84,166,211}
\definecolor{ATLASBlue_lighter}{RGB}{206,230,242}
\definecolor{ATLASBlue_lightest}{RGB}{243,249,252}
\definecolor{ATLASYellow}{RGB}{239,218,78}
\definecolor{ATLASPurple}{RGB}{86,86,215}
\definecolor{ATLASPink}{RGB}{211,81,255}
\definecolor{ATLASGreen}{RGB}{93,190,93}
\definecolor{ATLASOrange}{RGB}{255,173,53}
\definecolor{ATLASTurquoise}{RGB}{54,189,189}
\definecolor{UniBlue}{RGB}{8,58,130}
\definecolor{Black}{RGB}{0,0,0}
\definecolor{TemplateBlue}{RGB}{22,190,207}
\definecolor{TemplateWhite}{RGB}{255,255,255}
\definecolor{TemplateGrey}{RGB}{107,110,108}
\definecolor{LightGrey}{RGB}{224,224,224}

\definecolor{highred}{RGB}{255,178,178}
\definecolor{highgreen}{RGB}{178,255,178}
\definecolor{midgreen}{RGB}{0,153,0}

\definecolor{pastelgreen}{RGB}{168, 255, 181}
\definecolor{pastelred}{RGB}{249, 187, 187}

\makeatletter
\def\highlightLighter#1{%
  \fboxrule2pt %
  \hsize=\dimexpr\hsize-2\fboxrule-2\fboxsep\relax
  #1%
  \@endpbox\unskip\setbox0\lastbox\bgroup
  \fboxrule2pt %
  \fcolorbox{red}{ATLASBlue_lighter}{\box0}\hfill}

\makeatletter
\def\highlightLightest#1{%
  \fboxrule2pt %
  \hsize=\dimexpr\hsize-2\fboxrule-2\fboxsep\relax
  #1%
  \@endpbox\unskip\setbox0\lastbox\bgroup
  \fboxrule2pt %
  \fcolorbox{red}{ATLASBlue_lightest}{\box0}\hfill}



\makeatletter
\newcommand{\textsubsuperscript}[2]{%
  \begingroup
  \settowidth{\@tempdima}{\textsubscript{#1}}%
  \settowidth{\@tempdimb}{\textsuperscript{#2}}%
  \ifdim\@tempdima<\@tempdimb
  \setlength{\@tempdima}{\@tempdimb}%
  \fi
  \makebox[\@tempdima][l]{%
    \rlap{\textsubscript{#1}}\textsuperscript{#2}}%
  \endgroup}
\makeatother


\newsavebox{\ximagebox}
\newlength{\ximageheight}
\newsavebox{\xglyphbox}
\newlength{\xglyphheight}
\newcommand{\xbox}[1]%
   {\savebox{\ximagebox}{#1}%
    \settoheight{\ximageheight}{\usebox{\ximagebox}}%
    \savebox{\xglyphbox}{\char32}%
    \settoheight{\xglyphheight}{\usebox{\xglyphbox}}%
    \raisebox{\ximageheight}[0pt][0pt]{\raisebox{-\xglyphheight}[0pt][0pt]{%
      \makebox[0pt][l]{\usebox{\xglyphbox}}}}%
    \usebox{\ximagebox}%
    \raisebox{0pt}[0pt][0pt]{\makebox[0pt][r]{\usebox{\xglyphbox}}}}


\newcommand\elisa[1]{
 \href{https://atlasop.cern.ch/elisa/display/#1}
          {\xbox{\includegraphics[width=15pt]{themeImages/ELISA.png}}}%
}
\newcommand\JIRA[1]{
 \href{https://its.cern.ch/jira/browse/#1}
          {\xbox{\includegraphics[width=15pt]{themeImages/JIRA.png}}\hspace{-4pt}{\small\color{ATLASBlue}\underline{#1}}}%
}
\newcommand\formattedref[2]{
 \href{#1}
          {{\color{ATLASBlue}\underline{#2}}}%
}


\newcommand\imglink[3]{
 \href{#1}
          {\xbox{\includegraphics[width=#2]{#3}}}%
}


\newcommand\abs[1]{\left|#1\right|}

\newcommand\thickbar[1]{\accentset{\rule{.8em}{1.5pt}}{#1}}
\newcommand{\mt}{\ensuremath{\mathrm m_{T}}}
\newcommand{\pt}{\ensuremath{\mathrm p_{T}}}
% \newcommand{\met}{\ensuremath{ \cancel{E_{T}} }}
\newcommand{\met}{\ensuremath{ E_{T}^{miss} }}
\newcommand{\wprime}{\ensuremath{W^{\prime}}}
\newcommand{\wpplu}{\ensuremath{W^{\prime+}}}
\newcommand{\wpmin}{\ensuremath{W^{\prime-}}}
\newcommand{\zprime}{\ensuremath{Z^{\prime}}}

\newcommand\Wider[2][3em]{%
  \makebox[\linewidth][c]{%
    \begin{minipage}{\dimexpr\textwidth+#1\relax}
      \raggedright#2
    \end{minipage}%
  }%
}

\makeatletter
\newcommand{\extratiny}{\@setfontsize{\srcsize}{5pt}{5pt}}

\newcommand\HUGE{\@setfontsize\Huge{35pt}{35pt}} 

\makeatother

% checklist
\usepackage{pifont}
\newcommand{\cmark}{\ding{51}}%
\newcommand{\xmark}{\ding{55}}%
\newcommand{\donemark}{\rlap{$\square$}{\raisebox{2pt}{\large\hspace{1pt}\cmark}}%
    \hspace{-2.5pt}}
\newcommand{\notdonemark}{\rlap{$\square$}{\large\hspace{1pt}\xmark}}
\def\done #1 {\begin{itemize}\item[\donemark] #1\end{itemize}\vspace{-\topsep}}
\def\notdone #1 {\begin{itemize}\item[\notdonemark] #1\end{itemize}\vspace{-\topsep}}
\def\reason #1 {\vspace{-5pt}\begin{itemize}\item[]\begin{itemize}{\setlength\itemindent{-10pt} \item[]} #1\end{itemize}\end{itemize}\vspace{-\topsep}}

% margins
\setbeamersize{text margin left=0.5cm}
\setbeamersize{text margin right=0.5cm}


% basicstyle={\ttfamily\extratiny}

\setmainfont{Source Serif Pro}% Semibold}
\setsansfont{Source Sans Pro}% SemiBold}
\setmonofont{Source Code Pro}% Semibold}

% set colours
\setbeamercolor{itemize item}{fg=Black}
\setbeamercolor{enumerate item}{fg=Black}
\setbeamercolor{alerted text}{fg=Black}
\setbeamercolor{section in toc}{fg=Black}

% set fonts
\setbeamerfont{itemize/enumerate body}{size=\normalsize}
\setbeamerfont{itemize/enumerate subbody}{size=\normalsize}
\setbeamerfont{itemize/enumerate subsubbody}{size=\small}



% custom itemize bullets points >

\defbeamertemplate{itemize item}{image}{\small\includegraphics[height=1.6ex]{/home/ellis/LaTeX/Slides/themeImages/bullet.png}}
\defbeamertemplate{itemize subitem}{image}{\scriptsize\includegraphics[height=1.6ex]{/home/ellis/LaTeX/Slides/themeImages/bullet.png}}
\defbeamertemplate{itemize subsubitem}{image}{\tiny\includegraphics[height=1.6ex]{/home/ellis/LaTeX/Slides/themeImages/bullet.png}}

\setbeamertemplate{itemize item}[image]
\setbeamertemplate{itemize subitem}[image]
\setbeamertemplate{itemize subsubitem}[image]


% disable navigation
\setbeamertemplate{navigation symbols}{}

% custom draw the title page above
\setbeamertemplate{title page}{}

% again, manually draw the frame title above
\setbeamertemplate{frametitle}{}

% disable "Figure:" in the captions
\setbeamertemplate{caption}{\tiny\insertcaption}
\setbeamertemplate{caption label separator}{}

\newcommand{\beginbackup}{
  \newcounter{framenumberbackup}
  \setcounter{framenumberbackup}{\value{framenumber}}
}
\newcommand{\backupend}{
  \addtocounter{framenumberbackup}{-\value{framenumber}}
  \addtocounter{framenumber}{\value{framenumberbackup}} 
}


% since I don't know a better way to do this, these are all switches
% doing `\setcounter{showProgressBar}{0}` will turn the progress bar off (I turn it off for Appendix slides)
% etc
\newcounter{showProgressBar}
\setcounter{showProgressBar}{1}
\newcounter{showSlideNumbers}
\setcounter{showSlideNumbers}{1}
\newcounter{showSlideTotal}
\setcounter{showSlideTotal}{1}

% use \makeatletter for our progress bar definitions
% progress bar idea from http://tex.stackexchange.com/a/59749/44221
% slightly adapted for visual purposes here
\makeatletter
\newcount\progressbar@tmpcounta% auxiliary counter
\newcount\progressbar@tmpcountb% auxiliary counter
\newdimen\progressbar@pbwidth %progressbar width
\newdimen\progressbar@tmpdim % auxiliary dimension

%%%%
\progressbar@pbwidth=\paperwidth
%%%%

\newdimen\slidewidth % auxiliary dimension
\newdimen\slideheight % auxiliary dimension

\newlength{\msize}
\setlength{\msize}{\dimexpr(\paperwidth-.75cm)\relax}



% make the progress bar go across the screen
\progressbar@pbwidth=\msize
%\progressbar@pbwidth=\the\paperwidth
\slidewidth=\the\paperwidth
\slideheight=\the\paperheight

% use tikz to draw everything
% it may not be the best, but it's easy to work with
% and looks good
% TODO: base title slide and contents slide on something other than slide numbers :/
\setbeamertemplate{background}{
  % deal with progress bar stuff
  % (calculate where it should go)
  \progressbar@tmpcounta=\insertframenumber
  \progressbar@tmpcountb=\inserttotalframenumber
  %\progressbar@tmpdim=\progressbar@pbwidth
  \progressbar@tmpdim=.5\progressbar@pbwidth
  \multiply\progressbar@tmpdim by \progressbar@tmpcounta
  \divide\progressbar@tmpdim by \progressbar@tmpcountb
  %%%
  \progressbar@tmpdim=2\progressbar@tmpdim
  %%%
  \begin{tikzpicture}
    % set up the entire slide as the canvas
    \useasboundingbox (0,0) rectangle(\the\paperwidth,\the\paperheight);
    
    % the background
    \fill[color=TemplateWhite] (0,0) rectangle(\the\paperwidth,\the\paperheight);
    
    
    
    % separate the drawing based on if we're the first (title) slide or not
    \ifnum\thepage=1\relax
    % the title page
	
	% background image
	\node[anchor=south west, inner sep=0cm, opacity=0.15] (/home/ellis/LaTeX/Slides/themeImages/unilogo) at (0cm,0cm)
    {\includegraphics[width=\slidewidth]{/home/ellis/LaTeX/Slides/themeImages/bubblechamber_blue.png}};    
    
    % draw the fills
    \fill[color=ATLASBlue] (0, 3.5cm) rectangle(\slidewidth,\slideheight);
    
    % draw the actual text
    \node[anchor=south,text width=\slidewidth-1cm,inner xsep=0.5cm] at (0.5\slidewidth,3.6cm) {\color{TemplateWhite}\HUGE\textbf{\inserttitle}};
    \node[anchor=north east,text width=\slidewidth-1cm,align=right] at (\slidewidth-0.4cm,3.6cm) {\color{ATLASBlue}\tiny\insertsubtitle};
    
    \node[anchor=north east, inner sep=0cm] (/home/ellis/LaTeX/Slides/themeImages/unilogo) at (0.965\slidewidth,0.955\slideheight)
   % {\includegraphics[width=5cm]{/home/ellis/LaTeX/Slides/themeImages/UVic-Logo-White.png}};
    {\includegraphics[width=5cm]{/home/ellis/LaTeX/Slides/themeImages/UVic_hst_rev.eps}};
    
    
   % \node[anchor=north west, inner sep=0cm] (/home/ellis/LaTeX/Slides/themeImages/unilogo) at (0.0\slidewidth,1.03\slideheight)
    %{\includegraphics[width=5cm]{/home/ellis/LaTeX/Slides/themeImages/ATLAS-Logo-Blue-invert-RGB.png}};
    \node[anchor=north west, inner sep=0cm] (/home/ellis/LaTeX/Slides/themeImages/unilogo) at (0.03\slidewidth,0.97\slideheight)
    {\includegraphics[width=4.5cm]{/home/ellis/LaTeX/Slides/themeImages/ATLAS-transparent.png}};
    
    
    
    % \node[above] at(0.5\slidewidth,2.3cm) {\color{Black}\tiny by};
    \node at (0.5\slidewidth,2.25cm) {\color{Black}\LARGE\textbf{\insertauthor}};
    \node at (0.5\slidewidth,1.5cm) {\color{Black}\Large\insertinstitute};
    
    % add the date in the corner
    \node[anchor=south west] at(0,0) {\color{Black}\scriptsize\insertdate};

    
    %{\includegraphics[height=3.4cm]{/home/ellis/LaTeX/Slides/themeImages/EM_ec_blue.png}};



    \else
    % NOT the title page
    % title bar
    \fill[color=ATLASBlue] (0, \slideheight-1.2cm) rectangle(\slidewidth,\slideheight);
    
    % swap the comment on these to add section titles to slide titles
    % \node[anchor=north,text width=11.8cm,inner xsep=0.5cm,inner ysep=0.25cm] at (6.4cm,9.6cm) {\color{TemplateWhite}\Large\textbf{\insertsectionhead: \insertframetitle}};
    \node[anchor=north,text width=\slidewidth-1cm,inner xsep=0.5cm,inner ysep=0.31cm, outer xsep=3.3cm] at (0.5\slidewidth,\slideheight) {\color{TemplateWhite}\LARGE\textbf{\insertframetitle}};
    
    \node[anchor=north east, inner sep=0cm] (/home/ellis/LaTeX/Slides/themeImages/unilogo) at (0.99\slidewidth,0.98\slideheight)
    {\includegraphics[width=.72cm]{/home/ellis/LaTeX/Slides/themeImages/UVic-Logo-White-Small.png}};

        
    % if we're showing a progress bar, show it
    % (I disable the progress bar and slide numbers for the "Appendix" slides)
    \ifnum \value{showProgressBar}>0\relax%
    % the the progress bar icon in the middle of the screen
    \draw[fill=ATLASBlue,draw=none] (0cm,0cm) rectangle(\slidewidth,0.27cm);
    \draw[fill=ATLASBlue_lighter,draw=none] (0cm,0cm) rectangle(\msize,0.25cm);
    % test
    %\draw[fill=ATLASBlue_light,draw=none] (\msize,0cm) rectangle(.8cm,0.25cm);
    \draw[fill=ATLASBlue,draw=none] (0cm,0cm) rectangle(\progressbar@tmpdim,0.25cm);
    
    % bottom information
    % \node[anchor=south west] at(0cm,0.25cm) {\color{TemplateGrey}\tiny\insertsection};
    % if slide numbers are active
    \ifnum \value{showSlideNumbers}>0\relax%
    % if slide totals are active
    \ifnum \value{showSlideTotal}>0\relax%
    % draw both slide number and slide total
    \node[anchor=south east] at(\slidewidth,-0.1cm) {\color{TemplateWhite}\tiny\insertframenumber/\inserttotalframenumber};
    \else
    % slide totals aren't active, don't draw them
    \node[anchor=south east] at(\slidewidth,-0.1cm) {\color{TemplateWhite}\tiny\insertframenumber};
    \fi
    \fi
    % don't show the progress bar?
    \else
    % section title in the bottom left
    \node[anchor=south west] at(0cm,0cm) {\color{TemplateGrey}\tiny\insertsection};
    % if we're showing slide numbers
    \ifnum \value{showSlideNumbers}>0\relax%
    % if slide totals are active
    \ifnum \value{showSlideTotal}>0\relax%
    % draw both slide number and slide total
    \node[anchor=south east] at(\slidewidth,0cm) {\color{TemplateWhite}\tiny\insertframenumber/\inserttotalframenumber};
    \else
    % slide totals aren't active, don't draw them
    \node[anchor=south east] at(\slidewidth,0cm) {\color{TemplateWhite}\tiny\insertframenumber};
    \fi
    \fi
    \fi
    \fi
  \end{tikzpicture}
}
\makeatother

% add section titles
\AtBeginSection{\frame{\sectionpage}}
\setbeamertemplate{section page}
{
  \begin{tikzpicture}
    % set up the entire slide as the canvas
    \useasboundingbox (0,0) rectangle(\slidewidth,\slideheight);
    % \fill[color=TemplateWhite] (0,0) rectangle(\the\paperwidth,\the\paperheight);
    
    % cover up the top bar
    \fill[color=TemplateWhite] (-1cm, 0cm) rectangle (\slidewidth, \slideheight+0.1cm);
    
    %background image
    \node[anchor=south west, inner sep=0cm, opacity=0.15] (/home/ellis/LaTeX/Slides/themeImages/unilogo) at (-1cm,0cm)
    {\includegraphics[width=\slidewidth+1cm]{/home/ellis/LaTeX/Slides/themeImages/bubblechamber_blue.png}}; 
    	
    \fill[color=ATLASBlue] (-1cm, 0.5\slideheight-1cm) rectangle(\slidewidth, 0.5\slideheight+1cm);
    \node[text width=\the\paperwidth-1cm,align=center] at (0.4\slidewidth, 0.5\slideheight) {\color{TemplateWhite}\Huge\textbf{\insertsection}};
    
    %\node[align=center] (/home/ellis/LaTeX/Slides/themeImages/unilogo) at (0.8\slidewidth, 0.5\slideheight){\includegraphics[height=1.8cm]{/home/ellis/LaTeX/Slides/themeImages/ATLAS-Logo-Square-Blue-Globe.png}};
  \end{tikzpicture}
}



\addtobeamertemplate{frametitle}{}{\vspace{0.3cm}} % increase



% Easier bullet points from Carl 
% put the contents in curly brackets
\def\li #1 {\begin{itemize}\item #1\end{itemize}\vspace{-\topsep}}
\def\lii #1 {\begin{itemize}\item[]\begin{itemize}\item #1\end{itemize}\end{itemize}\vspace{-\topsep}}
\def\liii #1 {\begin{itemize}\item[]\begin{itemize}\item[]\begin{itemize}\item #1\end{itemize}\end{itemize}\end{itemize}\vspace{-\topsep} }

\setbeamercolor{itemize/enumerate subbody}{fg=ATLASBlue}
\setbeamercolor{itemize/enumerate subsubbody}{fg=ATLASBlue}



% Easy columns from Carl
% Argument is fraction of page width
\newcommand{\cleft}[1]{\begin{columns}[T]\begin{column}{#1\textwidth}}
\newcommand{\cright}[1]{\end{column}\begin{column}{#1\textwidth}}
\newcommand{\cend}{\end{column}\end{columns}}


%% ADD SLIDES FROM ANOTHER SOURCE
\usepackage{pdfpages}

%\setbeamercolor{background canvas}{bg=}
%\includepdf[pages={2-}]{plots/hadhad/DeficitCheck.pdf}












%\usepackage{pst-node, auto-pst-pdf}
%\usepackage{rotating}

%\usetikzlibrary{fit}
% boxes (main text area)
\setbeamercolor*{block body}{bg=ATLASBlue_light,fg=white}
\setbeamerfont{block body}{size=\scriptsize,series=\bf}
%tintedbubble.png
% box headers
\setbeamercolor*{block title}{fg=white,bg=ATLASBlue}
\setbeamerfont{block title}{size=\Large,series=\bf}
\setbeamercolor{upper separation line head}{fg=ATLASBlue}
\addtobeamertemplate{block begin}{\setlength\abovedisplayskip{0pt}}


\setbeamertemplate{block begin}{
  \vskip.75ex
  %\begin{beamercolorbox}[ht=3.5ex,dp=0.5ex,center,leftskip=-1em,colsep*=.75ex]{block title}%
   % \usebeamerfont*{block title}%
   % {\phantom{Gg}\insertblocktitle}% phantom because of baseline problem
  %\end{beamercolorbox}%
  {\ifbeamercolorempty[bg]{block body}{}{\nointerlineskip\vskip-0.2pt}}%
  \usebeamerfont{block body}%
  \begin{beamercolorbox}[leftskip=3pt,colsep*=.75ex,sep=-4pt,vmode]{block body}%
    \ifbeamercolorempty[bg]{block body}{\vskip-3pt}{\vskip-1pt}\vbox{}%
  }
  \setbeamertemplate{block end}{
  \end{beamercolorbox}
}


\newcommand*\rot{\rotatebox{90}}
\newcommand*\OK{\ding{51}}

\newcommand{\mcrot}[4]{\multicolumn{#1}{#2}{\rlap{\rotatebox{#3}{#4}~}}} 

\newcommand*{\twoelementtable}[3][l]%
{%  
    \renewcommand{\arraystretch}{0.8}%
    \begin{tabular}[t]{@{}#1@{}}%
        #2\tabularnewline
        #3%
    \end{tabular}%
}


\usetikzlibrary{patterns}
\newcommand\mmybox[2][fill=white, pattern=crosshatch, pattern color=gray!30]{%
    \tikz[baseline]\node[%
        inner ysep=0pt, 
        inner xsep=2pt, 
        anchor=text, 
        rectangle, 
        %rounded corners=1mm,
        #1] {\strut#2};%
}

\usepackage{pgf-pie,etoolbox}

\makeatletter
\patchcmd\pgfpie@slice
  {node {\scalefont{#3}\beforenumber#3\afternumber}}
  {node[/every only number node/.try] {\scalefont{#3}\beforenumber#3\afternumber}}{}{}
\makeatother

\usetikzlibrary{decorations.pathreplacing}

\pgfdeclaremetadecoration{raisedbrace}{initial}{%
\state{initial}[width=\pgfmetadecoratedpathlength]{%
  \decoration{brace}%
  \pgfsetdecorationsegmenttransformation{%
      \pgftransformyshift{\pgfmetadecorationsegmentamplitude}%
  }
  \beforedecoration{
    \pgfpathmoveto{\pgfpointmetadecoratedpathfirst}
    \pgfpathlineto{\pgfpointadd{%
      \pgfpointmetadecoratedpathfirst%
      }{%
      \pgfpointpolar{\pgfdecoratedangle+90}{\pgfmetadecorationsegmentamplitude}%
      }%
    }%
  }%
  \afterdecoration{%
    \pgfpathlineto{\pgfpointmetadecoratedpathlast}%
    \pgfusepath{stroke}
  }
}
}

\usetikzlibrary{tikzmark}



% Nice diagrams with jets
\tikzset{
 	  pics/jet/.style n args={3}{
        % default rotation: 0 degrees (jet progressing to right)
        code={
            \draw [fill=#1!30, thick,join=round](0, 0) -- (#2, -#3) -- (#2, #3) --cycle;
            \draw [fill=#1!20, thick](#2, 0) ellipse (#3/3 and #3);
            \draw [thick, ->, >=latex, color=black, fill=#1!90](0, 0)--(#2+#3, 0);
            
            \draw [thick, ->, >=latex, color=black, fill=#1!90](0, 0)--(#2+#3-0.1,{(#3-0.1)/2} );
            \draw [thick, ->, >=latex, color=black, fill=#1!90](0, 0)--(#2+#3-0.1, {-(#3-0.1)/2});
           \draw [thick, ->, >=latex, color=black, fill=#1!90](0, 0)--(#2+#3-0.2, #3-0.1);
      	     \draw [thick, ->, >=latex, color=black, fill=#1!90](0, 0)--(#2+#3-0.2,{-(#3-0.1)});
          
        }
    }
}
